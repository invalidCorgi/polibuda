używane struktury:

struct msgbuf{
    long mtype;
    char nadawca[dozwolona_dlugosc_nazwy];
    char adresat[dozwolona_dlugosc_nazwy];
    char text[dlugosc_wiadomosci];
};

Jest to struktura używana do przekazywania wiadomości, z charakterystycznym dla niej polem mtype. Nadawca zawiera nazwę użytkownika, który nadał wiadomość wraz ze znakiem końca linii. Adresat zawiera nazwę użytkownika lub grupy, do której jest adresowana wiadomość. Serwer w żaden sposób nie zmienia pól nadawca i adresat. Pole text zawiera treść wiadomości zależną od typu komunikatu.

struct klient{
    long mtype;
    int zalogowany;
    char nazwa[dozwolona_dlugosc_nazwy];
};

Jest to struktura używana do przechowywania informacji o użytkowniku. Pole mtype przechowuje mtype po którym użytkownik otrzymuje wiadomości z serwera. Pole zalogowany przechowuje wartość 0, gdy klient nie jest aktualnie zalogowany na serwerze, w przeciwnym wypadku przechowuje wartość 1. Pole nazwa przechowuje nazwę użytkownika wraz ze znakiem końca linii.

struct grupa{
    int liczba_klientow_w_grupie;
    struct klient *zapisani_klienci[liczba_klientow];
    char nazwa[dozwolona_dlugosc_nazwy];
};

Jest to struktura używana do przechowywania informacji o grupie. liczba_klientow_w_grupie jest polem przydatnym podczas iterowania po wszystkich zapisanych klientach. Pole zapisani_klienci przechowuje wskazniki na struktury klientów zapisanych do grupy. Pole nazwa przechowuje nazwę grupy wraz ze znakiem końca linii.

Protokół komunikacji:

Do komunikacji używane są dwie kolejki komunikatów jedna wchodząca na serwer, druga wychodząca z serwera. Klienci wysyłają żądania na kolejkę wchodząca serwera o mtype od 1 do 9, w każdej wiadomości umieszczając w polu nadawca swoją nazwę użytkownika. Serwer odpowiada wiadomościami na kolejkę wychodzącą o mtype przypisanych użytkownikowi, który jest wpisany w polu nadawca z wyjątkiem odpowiedzi na żądanie logowania i wylogowania.

mtype 1 oznacza żądanie logowania, gdzie klient wysyła nazwę użytkownika, na którego konto chce się zalogować w polu nadawca, i natychmiast czeka na odpowiedź o mtype 1 zawierającą w polu text mtype użytkownika, na którego konto się zalogował, -1 jeśli serwer przy przetwarzaniu żądania nie znalazł użytkownika o podanej nazwie, bądź 0 jeśli jest on już zalogowany. Klient po odebraniu mtype większego niż 0 tworzy wątek, który odbiera komunikaty o odebranym mtype z kolejki wychodzącej serwera.

mtype 2 oznacza żądanie wylogowania, gdzie klient po wysłaniu żądania natychmiast czeka na odpowiedź o mtype 2 i wyświetla treść odpowiedzi. W tym czasie serwer ustawia pole zalogowany użytkownika na 0 i wysyła potwierdzenie wylogowania. Klient podczas wylogowywania zabija wątek odbierający wiadomości z kolejki wychodzącej serwera. 

mtype 3 oznacza żądanie podglądu zalogowanych użytkowników, klient wysyła żądanie, serwer do pola text wpisuje wiadomość zawierającą informację "\nZalogowani uzytkownicy:\n" i kolejnych użytkowników, którzy mają ustawione pole zalogowany na 1 i wysyła odpowiedź.

mtype 4 oznacza żądanie podglądu użytkowników zapisanych do podanej grupy, klient umieszcza w polu text nazwę grupy wpisaną przez użytkownika i wysyła żądanie. Serwer do pola text wpisuje wiadomość zawierającą informację "\nPodana grupa nie istnieje\n" jeśli nie znajdzie w bazie danych grupy o nazwie podanej przez użytkownika lub informację "\nZapisani uzytkownicy do grupy " wraz z nazwą grupy i nazwami użytkowników zapisanych do podanej grupy i wysyła odpowiedź.

mtype 5 oznacza żądanie zapisu do grupy, klient umieszcza w polu text nazwę grupy wpisaną przez użytkownika i wysyła żądanie. Serwer do pola text wpisuje wiadomość zawierającą informację "\nPodana grupa nie istnieje\n" jeśli nie znajdzie w bazie danych grupy o nazwie podanej przez użytkownika, informację "\nJestes juz zapisany do tej grupy\n" jeśli w grupie podanej przez użytkownika znajduje się już użytkownik o nazwie z pola nadawca. Jeśli nie są to takie przypadki, to serwer dopisuje nadawcę na koniec listy zapisanych użytkowników podanej grupy i wpisuje do pola text wiadomość z potwierdzeniem powodzenia operacji. Na koniec wysyła odpowiedź.

mtype 6 oznacza żądanie wypisania się z grupy. Komunikacja wygląda jak przy zapisie do grupy.

mtype 7 oznacza żądanie podglądu dostępnych grup, klient wysyła żądanie, serwer do pola text wpisuje wiadomość zawierającą informację "\nDostepne grupy:\n", nazwy wszystkich grup istniejących na serwerze i wysyła odpowiedź.

mtype 8 oznacza wiadomość do grupy, klient umieszcza w polu adresat podana przez uzytkownika nazwe grupy, a w polu text podaną przez użytkownika treść wiadomości. Serwer jeśli znajdzie podaną grupę, to przesyła wiadomość bez zmian do każdego członka grupy oprócz nadawcy. Klient podczas odbioru wiadomości identyfikuje wiadomość jako wiadomość od grupy po tym, że żadne z pól adresat i nadawca nie zawiera nazwy użytkownika, który odbiera wiadomość.

mtype 9 oznacza wiadomość do użytkownika, klient umieszcza w polu adresat podana przez uzytkownika nazwe użytkownika, a w polu text podaną przez użytkownika treść wiadomości. Serwer jeśli znajdzie podanego użytkownika, to przesyła do niego wiadomość bez zmian. Klient podczas odbioru wiadomości identyfikuje wiadomość jako indywidualną wiadomość do niego po tym, że pole adresat zawiera jego nazwę użytkownika.