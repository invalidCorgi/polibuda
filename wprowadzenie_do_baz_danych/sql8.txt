insert into pracowniCY
values('250','KOWALSKI','ASYSTENT',NULL,'2015-01-13','1500',NULL,'10');
insert into pracowniCY
values('260','ADAMSKI','ASYSTENT',NULL,'2014-09-10','1500',NULL,'10');
insert into pracowniCY
values('270','NOWAK','ADIUNKT',NULL,'1990-05-01','2050','540','20');

SELECT *
FROM PRACOWNICY
WHERE ID_PRAC IN ('250','260','270');

UPDATE PRACOWNICY
SET PLACA_POD=PLACA_POD*1.1,
PLACA_DOD=case
when placa_dod is null then 100
else placa_dod*1.2 end
WHERE ID_PRAC IN ('250','260','270');

insert into zespoly
values(60,'BAZY DANYCH','PIOTROWO 2');

SELECT * FROM ZESPOLY
WHERE ID_ZESP=60;

UPDATE PRACOWNICY
SET ID_ZESP=
(SELECT ID_ZESP FROM ZESPOLY
WHERE NAZWA='BAZY DANYCH')
WHERE ID_PRAC IN ('250','260','270');

SELECT * FROM PRACOWNICY JOIN ZESPOLY USING(ID_ZESP)
WHERE ID_ZESP=60;

UPDATE PRACOWNICY
SET ID_SZEFA=
(SELECT ID_PRAC FROM PRACOWNICY
WHERE NAZWISKO='MORZY')
WHERE ID_PRAC IN ('250','260','270');

SELECT * FROM PRACOWNICY
WHERE ID_SZEFA=
(SELECT ID_PRAC FROM PRACOWNICY
WHERE NAZWISKO='MORZY');

DELETE ZESPOLY
WHERE NAZWA='BAZY DANYCH';

DELETE PRACOWNICY
WHERE ID_ZESP=
(SELECT ID_ZESP FROM ZESPOLY
WHERE NAZWA='BAZY DANYCH');

SELECT NAZWISKO, PLACA_POD,
(SELECT 0.1*AVG(PLACA_POD)
FROM PRACOWNICY P2
GROUP BY ID_ZESP
HAVING ID_ZESP=P1.ID_ZESP)
FROM PRACOWNICY P1
ORDER BY NAZWISKO;

UPDATE PRACOWNICY P1
SET PLACA_POD=PLACA_POD+
(SELECT 0.1*AVG(PLACA_POD)
FROM PRACOWNICY P2
GROUP BY ID_ZESP
HAVING ID_ZESP=P1.ID_ZESP);

SELECT * FROM PRACOWNICY
ORDER BY NAZWISKO;

SELECT * FROM PRACOWNICY
ORDER BY PLACA_POD FETCH FIRST 1 ROWS WITH TIES;

UPDATE PRACOWNICY
SET PLACA_POD=
(SELECT ROUND(AVG(PLACA_POD),2)
FROM PRACOWNICY)
WHERE ID_PRAC=
(SELECT ID_PRAC FROM PRACOWNICY
ORDER BY PLACA_POD FETCH FIRST 1 ROWS WITH TIES);

SELECT NAZWISKO, PLACA_DOD
FROM PRACOWNICY
WHERE ID_ZESP=20
ORDER BY NAZWISKO;

UPDATE PRACOWNICY
SET PLACA_DOD=
(SELECT ROUND(AVG(PLACA_POD),1)
FROM PRACOWNICY
GROUP BY ID_SZEFA
HAVING ID_SZEFA=
(SELECT ID_PRAC
FROM PRACOWNICY
WHERE NAZWISKO='MORZY'))
WHERE ID_ZESP=20;

SELECT ROUND(AVG(PLACA_POD),1)
FROM PRACOWNICY
GROUP BY ID_SZEFA
HAVING ID_SZEFA=
(SELECT ID_PRAC
FROM PRACOWNICY
WHERE NAZWISKO='MORZY');

UPDATE
(SELECT * FROM PRACOWNICY JOIN ZESPOLY USING(ID_ZESP)
WHERE NAZWA='SYSTEMY ROZPROSZONE')
SET PLACA_POD=PLACA_POD*1.25;

DELETE FROM
(SELECT p.nazwisko as pracownik, s.nazwisko as szef
FROM PRACOWNICY P JOIN PRACOWNICY S
ON P.ID_SZEFA=S.ID_PRAC
WHERE S.NAZWISKO='MORZY');

create sequence prac_seq start with 300 increment by 10;

insert into PRACOWNICY(ID_PRAC,NAZWISKO,ETAT,PLACA_POD)
values(prac_seq.nextval,'Trąbczyński','STAZYSTA',1000);

select * from PRACOWNICY;

update PRACOWNICY set PLACA_DOD=prac_seq.currval
where NAZWISKO='Trąbczyński';

delete PRACOWNICY where NAZWISKO='Trąbczyński';

create sequence mala_seq maxvalue 10;

select mala_seq.nextval from dual;

drop sequence mala_seq;

select * from user_sequences;